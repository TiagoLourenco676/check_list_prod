function generatePDF() {
            // Atualizar legendas antes de gerar PDF
            updateImageLegends();
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('l', 'mm', 'a4');
            
            const data = document.getElementById('data').value;
            const verificador = document.getElementById('verificador').value;
            
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text('CHECK LIST CQ PRODUCAO - OFFICE 365', 148, 20, { align: 'center' });
            
            doc.setFontSize(12);
            doc.setFont(undefined, 'normal');
            doc.text(`Data: ${data || '_____/_____/_____'}`, 20, 35);
            doc.text(`Verificador: ${verificador || '________________________'}`, 150, 35);
            
            const tableData = [];
            const hourValidationData = []; // Array para armazenar informações de validação de horário
            const rows = document.querySelectorAll('#checklistBody tr:not(.empty-state)');
            
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('td');
                
                if (cells.length > 0) {
                    const rowData = [];
                    
                    const hora = cells[0].textContent.replace('×', '').trim();
                    rowData.push(hora);
                    
                    // Capturar informação de validação de horário
                    const hourCell = cells[0];
                    let hourValidation = 'default';
                    if (hourCell.classList.contains('time-valid')) {
                        hourValidation = 'valid';
                    } else if (hourCell.classList.contains('time-warning')) {
                        hourValidation = 'warning';
                    } else if (hourCell.classList.contains('time-danger')) {
                        hourValidation = 'danger';
                    }
                    hourValidationData.push(hourValidation);
                    
                    const opInput = cells[1].querySelector('.op-input');
                    rowData.push(opInput ? opInput.value : '');
                    
                    for (let i = 2; i < cells.length - 1; i++) {
                        const activeBtn = cells[i].querySelector('.status-btn.active');
                        let status = '';
                        
                        if (activeBtn?.classList.contains('btn-ok')) {
                            status = 'OK';
                        } else if (activeBtn?.classList.contains('btn-atencao')) {
                            status = 'ATENCAO';
                        } else if (activeBtn?.classList.contains('btn-nok')) {
                            status = 'NAO OK';
                        }
                        
                        rowData.push(status);
                    }
                    
                    const obsInput = cells[cells.length - 1].querySelector('.obs-input');
                    rowData.push(obsInput ? obsInput.value : '');
                    
                    tableData.push(rowData);
                }
            });
            
            const headers = [
                'HORA',
                'O.P',
                'MATERIAIS BOM',
                'PROCESSOS/INSTRUCAO',
                'MATRIZ COMPETENC.',
                'ETIQUETAS',
                'OBSERVACOES'
            ];
            
            doc.autoTable({
                head: [headers],
                body: tableData,
                startY: 45,
                styles: {
                    fontSize: 8,
                    cellPadding: 3,
                    valign: 'middle',
                    halign: 'center'
                },
                headStyles: {
                    fillColor: [44, 62, 80],
                    textColor: [255, 255, 255],
                    fontStyle: 'bold',
                    fontSize: 9
                },
                columnStyles: {
                    0: { cellWidth: 18, halign: 'center' }, // HORA
                    1: { cellWidth: 20, halign: 'center' }, // O.P
                    2: { cellWidth: 35, halign: 'center' }, // MATERIAIS (reduzido)
                    3: { cellWidth: 40, halign: 'center' }, // PROCESSOS/IT (aumentado)
                    4: { cellWidth: 35, halign: 'center' }, // MATRIZ (reduzido)
                    5: { cellWidth: 25, halign: 'center' }, // ETIQUETAS
                    6: { cellWidth: 45, halign: 'left' }    // OBSERVAÇÕES
                },
                didParseCell: function(data) {
                    // Colorir células baseado no status com cores mais vivas
                    if (data.cell.text[0]) {
                        if (data.cell.text[0] === 'OK') {
                            data.cell.styles.fillColor = [212, 237, 218]; // Verde mais visível
                            data.cell.styles.textColor = [21, 87, 36];    // Verde escuro
                            data.cell.styles.fontStyle = 'bold';
                            data.cell.styles.fontSize = 9;
                        } else if (data.cell.text[0] === 'ATENCAO') {
                            data.cell.styles.fillColor = [255, 243, 205]; // Amarelo mais visível
                            data.cell.styles.textColor = [133, 100, 4];   // Amarelo escuro
                            data.cell.styles.fontStyle = 'bold';
                            data.cell.styles.fontSize = 9;
                        } else if (data.cell.text[0] === 'NAO OK') {
                            data.cell.styles.fillColor = [248, 215, 218]; // Vermelho mais visível
                            data.cell.styles.textColor = [114, 28, 36];   // Vermelho escuro
                            data.cell.styles.fontStyle = 'bold';
                            data.cell.styles.fontSize = 9;
                        }
                    }
                    
                    // Aplicar cores às células de hora baseado na validação de horário
                    if (data.column.index === 0 && data.cell.text[0] && data.cell.text[0].includes(':')) {
                        const rowIndex = data.row.index;
                        const validation = hourValidationData[rowIndex];
                        
                        if (validation === 'valid') {
                            // Verde - horário válido
                            data.cell.styles.fillColor = [212, 237, 218];
                            data.cell.styles.textColor = [21, 87, 36];
                            data.cell.styles.fontStyle = 'bold';
                        } else if (validation === 'warning') {
                            // Amarelo - horário com atenção
                            data.cell.styles.fillColor = [255, 243, 205];
                            data.cell.styles.textColor = [133, 100, 4];
                            data.cell.styles.fontStyle = 'bold';
                        } else if (validation === 'danger') {
                            // Vermelho - horário crítico
                            data.cell.styles.fillColor = [248, 215, 218];
                            data.cell.styles.textColor = [114, 28, 36];
                            data.cell.styles.fontStyle = 'bold';
                        } else {
                            // Cor padrão para horários sem validação específica
                            data.cell.styles.fillColor = [236, 240, 241];
                            data.cell.styles.fontStyle = 'bold';
                            data.cell.styles.textColor = [44, 62, 80];
                        }
                    }
                }
